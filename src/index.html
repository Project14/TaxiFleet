<!DOCTYPE html>
<html ng-app="taxi" lang="en">
   
<head>
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.3/angular.min.js"></script>
    <script type="text/javascript" src='app.js'></script> 
</head>

<body ng-controller="driver as taxiDriver" class="container" ng-init="driver=0; dispatch=0; login=0"> <!--Starting the angular controller-->
    
    <h1>WitsCABS <em class="pull-right"><button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#selectview" ng-show='login' ng-click="dispatch = 0; driver = 0; login = 0">Log Out</button></em></h1>

    <!--Beginning of login modal-->
    <div id="selectview" class="modal fade" role="login">
        
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Login As</h4>
                </div>
                <div class="modal-body">
                    <p> <button type="button" class="btn btn-primary btn-block" ng-click="driver =1 ; dispatch =0; login =1" data-dismiss="modal">Driver</button></p>
                    <p> <button type="button" class="btn btn-primary btn-block" ng-click="dispatch =1; driver =0; login =1" data-dismiss="modal">Dispatch</button></p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="login = 0">Close</button>
                </div>
            </div>
        </div>
        
    </div>
    
    <!--Default state before login-->
    <div ng-hide='login'>
    
        <h1 >Please log in to proceed</h1>
        <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#selectview" ng-click="dispatch = 0; driver = 0 login=1">Log In</button>
        
    </div>

    <!--Driver view after login-->
    <div class="panel panel-info" ng-repeat="customer in taxiDriver.jobs |filter: {driverAssigned:false} |orderBy: 'distance' |limitTo: 1" ng-show= "driver"> <!-- List the closest customer with no driver assigned-->
        
        <div class="panel-heading">
        <h2> 
            {{customer.name}}
            <em class="pull-right"> Distance: {{customer.distance}}km</em>
        </h2>
        </div>

        <div class="panel-body">
        <p> {{customer.description}} </p>
        <p> Phone: {{customer.phone}} </p>

        <button type="button" class="btn btn-default">On the way</button>
        <button type="button" class="btn btn-info">Job complete</button>
        </div>
        
    </div>
    <!--Dispatch view after login-->
    <div ng-show='dispatch'>
        
        <p>Dispatch View</p>   
        
    </div>
    
</body>

</html>